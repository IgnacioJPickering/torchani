# parameters associated with dataset
#
random_search:
    lr: [1.e-5, 1.e-3]
    patience: [10, 40]
    factor: [0.5, 0.9]
    weigth_decay: [1.e-8, 1.e-4]
    beta: [5, 20]

datasets:
    # this is the ANI1x released dataset
    dataset_path: 'ani1x_release.pkl'
    batch_size: 2048
    split_percentage: 0.8
    nonstandard_keys : 
        species: 'species'
        coordinates: 'coordinates'
        energies: 'energies'

# general parameters
general:
    early_stopping_lr: 1.0e-10
    max_epochs: 3000
    

loss:
    class: 'RootAtomsLoss'

optimizer:
    class: 'AdamW'
    lr: 0.0005
    betas: [0.9, 0.999]
    weight_decay: 1.0e-7
    amsgrad: False
    eps: 1.0e-8

lr_scheduler:
    class: 'ReduceLROnPlateau'
    patience: 10
    threshold: 6.e-4
    factor: 0.7

validation_function: 'validate_energies'

init:
    function: 'init_sharp_gaussian'


# These hyperparameters are used for constructing the different parts of the
# TemplateModel, the class needs to be specified, along with a list of all the
# hyperparameters for that class

# no custom class is supported for this at the moment
species_converter:
    species: ['H', 'C', 'N', 'O']

# AEVComputerJoint Hyperparameters
# Note that the classmethod "cover_linearly" is called for this class, 
# for all other classes the normal constructor is called
aev_computer:
    class: 'AEVComputerJoint'  
    radial_cutoff: 5.2000e+00
    angular_cutoff: 3.5000e+00
    radial_eta: 16.0
    angular_eta: 8.0
    radial_dist_divisions: 16
    angular_dist_divisions: 4
    zeta: 32.0
    angle_sections: 8
    num_species: 4
    radial_start: 0.9000e+00
    angular_start: 0.9000e+00

# ANIModel Hyperparameters
ani_model:
    class: 'ANIModelMultiple'
    squeeze_last: True

# AtomicNetwork Hyperparameters
atomic_network:
    class: 'AtomicNetworkSoftPlus'
    beta: 10
    dim_in: 384
    dims:  [128, 112, 96]
    final_layer_bias: True

# no custom class is supported for this at the moment
energy_shifter:
    num_species: 4
